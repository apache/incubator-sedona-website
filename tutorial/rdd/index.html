



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.7.1">
    
    
      
        <title>Spatial RDD application - GeoSpark</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="cyan" data-md-color-accent="pink">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#set-up-dependencies" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="GeoSpark" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                GeoSpark
              </span>
              <span class="md-header-nav__topic">
                Spatial RDD application
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/DataSystemsLab/GeoSpark/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    GeoSpark
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/DataSystemsLab/GeoSpark/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Download
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Download
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../download/overview/" title="Quick start" class="md-nav__link">
      Quick start
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../download/GeoSpark-All-Modules-Release-notes/" title="Release notes" class="md-nav__link">
      Release notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../download/GeoSpark-All-Modules-Maven-Central-Coordinates/" title="Maven Central coordinate" class="md-nav__link">
      Maven Central coordinate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../download/cluster/" title="Set up Spark cluser" class="md-nav__link">
      Set up Spark cluser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../download/scalashell/" title="Spark Scala shell" class="md-nav__link">
      Spark Scala shell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../download/project/" title="Self-contained project" class="md-nav__link">
      Self-contained project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../download/zeppelin/" title="Install GeoSpark-Zeppelin" class="md-nav__link">
      Install GeoSpark-Zeppelin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../download/compile/" title="Compile the source code" class="md-nav__link">
      Compile the source code
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Spatial RDD application
      </label>
    
    <a href="./" title="Spatial RDD application" class="md-nav__link md-nav__link--active">
      Spatial RDD application
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#set-up-dependencies" title="Set up dependencies" class="md-nav__link">
    Set up dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initiate-sparkcontext" title="Initiate SparkContext" class="md-nav__link">
    Initiate SparkContext
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-spatialrdd" title="Create a SpatialRDD" class="md-nav__link">
    Create a SpatialRDD
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-a-typed-spatialrdd" title="Create a typed SpatialRDD" class="md-nav__link">
    Create a typed SpatialRDD
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pointrdd-from-csvtsv" title="PointRDD from CSV/TSV" class="md-nav__link">
    PointRDD from CSV/TSV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polygonrddlinestringrdd-from-csvtsv" title="PolygonRDD/LineStringRDD from CSV/TSV" class="md-nav__link">
    PolygonRDD/LineStringRDD from CSV/TSV
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-generic-spatialrdd-behavoir-changed-in-v120" title="Create a generic SpatialRDD (behavoir changed in v1.2.0)" class="md-nav__link">
    Create a generic SpatialRDD (behavoir changed in v1.2.0)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-wktwkb" title="From WKT/WKB" class="md-nav__link">
    From WKT/WKB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-geojson" title="From GeoJSON" class="md-nav__link">
    From GeoJSON
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-shapefile" title="From Shapefile" class="md-nav__link">
    From Shapefile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-sparksql-dataframe" title="From SparkSQL DataFrame" class="md-nav__link">
    From SparkSQL DataFrame
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transform-the-coordinate-reference-system" title="Transform the Coordinate Reference System" class="md-nav__link">
    Transform the Coordinate Reference System
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read-other-attributes-in-an-spatialrdd" title="Read other attributes in an SpatialRDD" class="md-nav__link">
    Read other attributes in an SpatialRDD
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-a-spatial-range-query" title="Write a Spatial Range Query" class="md-nav__link">
    Write a Spatial Range Query
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#range-query-window" title="Range query window" class="md-nav__link">
    Range query window
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-spatial-indexes" title="Use spatial indexes" class="md-nav__link">
    Use spatial indexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-format" title="Output format" class="md-nav__link">
    Output format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-a-spatial-knn-query" title="Write a Spatial KNN Query" class="md-nav__link">
    Write a Spatial KNN Query
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query-center-geometry" title="Query center geometry" class="md-nav__link">
    Query center geometry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-spatial-indexes_1" title="Use spatial indexes" class="md-nav__link">
    Use spatial indexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-format_1" title="Output format" class="md-nav__link">
    Output format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-a-spatial-join-query" title="Write a Spatial Join Query" class="md-nav__link">
    Write a Spatial Join Query
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-spatial-partitioning" title="Use spatial partitioning" class="md-nav__link">
    Use spatial partitioning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-spatial-indexes_2" title="Use spatial indexes" class="md-nav__link">
    Use spatial indexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-format_2" title="Output format" class="md-nav__link">
    Output format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-a-distance-join-query" title="Write a Distance Join Query" class="md-nav__link">
    Write a Distance Join Query
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#save-to-permanent-storage" title="Save to permanent storage" class="md-nav__link">
    Save to permanent storage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save-an-spatialrdd-not-indexed" title="Save an SpatialRDD (not indexed)" class="md-nav__link">
    Save an SpatialRDD (not indexed)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save-to-distributed-wkt-text-file" title="Save to distributed WKT text file" class="md-nav__link">
    Save to distributed WKT text file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-to-distributed-wkb-text-file" title="Save to distributed WKB text file" class="md-nav__link">
    Save to distributed WKB text file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-to-distributed-geojson-text-file" title="Save to distributed GeoJSON text file" class="md-nav__link">
    Save to distributed GeoJSON text file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-to-distributed-object-file" title="Save to distributed object file" class="md-nav__link">
    Save to distributed object file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-an-spatialrdd-indexed" title="Save an SpatialRDD (indexed)" class="md-nav__link">
    Save an SpatialRDD (indexed)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save-to-distributed-object-file_1" title="Save to distributed object file" class="md-nav__link">
    Save to distributed object file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-an-spatialrdd-spatialpartitioned-wo-indexed" title="Save an SpatialRDD (spatialPartitioned W/O indexed)" class="md-nav__link">
    Save an SpatialRDD (spatialPartitioned W/O indexed)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reload-a-saved-spatialrdd" title="Reload a saved SpatialRDD" class="md-nav__link">
    Reload a saved SpatialRDD
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load-to-a-typed-spatialrdd" title="Load to a typed SpatialRDD" class="md-nav__link">
    Load to a typed SpatialRDD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-to-a-generic-spatialrdd" title="Load to a generic SpatialRDD" class="md-nav__link">
    Load to a generic SpatialRDD
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sql/" title="Spatial SQL application" class="md-nav__link">
      Spatial SQL application
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../viz/" title="Visualize Spatial DataFrame" class="md-nav__link">
      Visualize Spatial DataFrame
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../zeppelin/" title="Run GeoSpark via Zeppelin" class="md-nav__link">
      Run GeoSpark via Zeppelin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../geospark-core-python/" title="Spatial RDD in Python" class="md-nav__link">
      Spatial RDD in Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../geospark-sql-python/" title="Spatial SQL in Python" class="md-nav__link">
      Spatial SQL in Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../GeoSpark-Runnable-DEMO/" title="GeoSpark template project" class="md-nav__link">
      GeoSpark template project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../faq/" title="Frequently Asked Questions" class="md-nav__link">
      Frequently Asked Questions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Advanced-Tutorial-Tune-your-GeoSpark-Application/" title="Tune GeoSpark RDD application" class="md-nav__link">
      Tune GeoSpark RDD application
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../benchmark/" title="Benchmark" class="md-nav__link">
      Benchmark
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1">
    
    <label class="md-nav__link" for="nav-4-1">
      GeoSpark core (RDD)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        GeoSpark core (RDD)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/GeoSpark-Scala-and-Java-API/" title="Scala/Java doc" class="md-nav__link">
      Scala/Java doc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/GeoSpark-Python-API/" title="Python doc" class="md-nav__link">
      Python doc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      GeoSpark SQL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        GeoSpark SQL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/sql/GeoSparkSQL-javadoc/" title="JavaDoc" class="md-nav__link">
      JavaDoc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/sql/GeoSparkSQL-Overview/" title="Quick start" class="md-nav__link">
      Quick start
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/sql/GeoSparkSQL-Constructor/" title="Constructor" class="md-nav__link">
      Constructor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/sql/GeoSparkSQL-Function/" title="Function" class="md-nav__link">
      Function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/sql/GeoSparkSQL-Predicate/" title="Predicate" class="md-nav__link">
      Predicate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/sql/GeoSparkSQL-AggregateFunction/" title="Aggregate function" class="md-nav__link">
      Aggregate function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/sql/GeoSparkSQL-Optimizer/" title="Join query (optimizer)" class="md-nav__link">
      Join query (optimizer)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/sql/GeoSparkSQL-Parameter/" title="Parameter" class="md-nav__link">
      Parameter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      GeoSpark Viz
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        GeoSpark Viz
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/viz/sql/" title="DataFrame/SQL" class="md-nav__link">
      DataFrame/SQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/viz/Babylon-Scala-and-Java-API/" title="RDD" class="md-nav__link">
      RDD
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Contributing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Contributing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../contribute/rule/" title="Contributing rule" class="md-nav__link">
      Contributing rule
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contribute/contributor/" title="Contributors and committers" class="md-nav__link">
      Contributors and committers
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contact/" title="Contact" class="md-nav__link">
      Contact
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../publication/" title="Publications" class="md-nav__link">
      Publications
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      License
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        License
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../license/License-before-1-2-0/" title="License-before-1.2.0" class="md-nav__link">
      License-before-1.2.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../license/License/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#set-up-dependencies" title="Set up dependencies" class="md-nav__link">
    Set up dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initiate-sparkcontext" title="Initiate SparkContext" class="md-nav__link">
    Initiate SparkContext
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-spatialrdd" title="Create a SpatialRDD" class="md-nav__link">
    Create a SpatialRDD
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-a-typed-spatialrdd" title="Create a typed SpatialRDD" class="md-nav__link">
    Create a typed SpatialRDD
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pointrdd-from-csvtsv" title="PointRDD from CSV/TSV" class="md-nav__link">
    PointRDD from CSV/TSV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polygonrddlinestringrdd-from-csvtsv" title="PolygonRDD/LineStringRDD from CSV/TSV" class="md-nav__link">
    PolygonRDD/LineStringRDD from CSV/TSV
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-generic-spatialrdd-behavoir-changed-in-v120" title="Create a generic SpatialRDD (behavoir changed in v1.2.0)" class="md-nav__link">
    Create a generic SpatialRDD (behavoir changed in v1.2.0)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-wktwkb" title="From WKT/WKB" class="md-nav__link">
    From WKT/WKB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-geojson" title="From GeoJSON" class="md-nav__link">
    From GeoJSON
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-shapefile" title="From Shapefile" class="md-nav__link">
    From Shapefile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-sparksql-dataframe" title="From SparkSQL DataFrame" class="md-nav__link">
    From SparkSQL DataFrame
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transform-the-coordinate-reference-system" title="Transform the Coordinate Reference System" class="md-nav__link">
    Transform the Coordinate Reference System
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read-other-attributes-in-an-spatialrdd" title="Read other attributes in an SpatialRDD" class="md-nav__link">
    Read other attributes in an SpatialRDD
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-a-spatial-range-query" title="Write a Spatial Range Query" class="md-nav__link">
    Write a Spatial Range Query
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#range-query-window" title="Range query window" class="md-nav__link">
    Range query window
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-spatial-indexes" title="Use spatial indexes" class="md-nav__link">
    Use spatial indexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-format" title="Output format" class="md-nav__link">
    Output format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-a-spatial-knn-query" title="Write a Spatial KNN Query" class="md-nav__link">
    Write a Spatial KNN Query
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query-center-geometry" title="Query center geometry" class="md-nav__link">
    Query center geometry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-spatial-indexes_1" title="Use spatial indexes" class="md-nav__link">
    Use spatial indexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-format_1" title="Output format" class="md-nav__link">
    Output format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-a-spatial-join-query" title="Write a Spatial Join Query" class="md-nav__link">
    Write a Spatial Join Query
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-spatial-partitioning" title="Use spatial partitioning" class="md-nav__link">
    Use spatial partitioning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-spatial-indexes_2" title="Use spatial indexes" class="md-nav__link">
    Use spatial indexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-format_2" title="Output format" class="md-nav__link">
    Output format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-a-distance-join-query" title="Write a Distance Join Query" class="md-nav__link">
    Write a Distance Join Query
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#save-to-permanent-storage" title="Save to permanent storage" class="md-nav__link">
    Save to permanent storage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save-an-spatialrdd-not-indexed" title="Save an SpatialRDD (not indexed)" class="md-nav__link">
    Save an SpatialRDD (not indexed)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save-to-distributed-wkt-text-file" title="Save to distributed WKT text file" class="md-nav__link">
    Save to distributed WKT text file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-to-distributed-wkb-text-file" title="Save to distributed WKB text file" class="md-nav__link">
    Save to distributed WKB text file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-to-distributed-geojson-text-file" title="Save to distributed GeoJSON text file" class="md-nav__link">
    Save to distributed GeoJSON text file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-to-distributed-object-file" title="Save to distributed object file" class="md-nav__link">
    Save to distributed object file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-an-spatialrdd-indexed" title="Save an SpatialRDD (indexed)" class="md-nav__link">
    Save an SpatialRDD (indexed)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save-to-distributed-object-file_1" title="Save to distributed object file" class="md-nav__link">
    Save to distributed object file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-an-spatialrdd-spatialpartitioned-wo-indexed" title="Save an SpatialRDD (spatialPartitioned W/O indexed)" class="md-nav__link">
    Save an SpatialRDD (spatialPartitioned W/O indexed)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reload-a-saved-spatialrdd" title="Reload a saved SpatialRDD" class="md-nav__link">
    Reload a saved SpatialRDD
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load-to-a-typed-spatialrdd" title="Load to a typed SpatialRDD" class="md-nav__link">
    Load to a typed SpatialRDD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-to-a-generic-spatialrdd" title="Load to a generic SpatialRDD" class="md-nav__link">
    Load to a generic SpatialRDD
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/DataSystemsLab/GeoSpark/edit/master/docs/tutorial/rdd.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Spatial RDD application</h1>
                
                <p>The page outlines the steps to create Spatial RDDs and run spatial queries using GeoSpark-core. <mark>The example code is written in Scala but also works for Java</mark>.</p>
<h2 id="set-up-dependencies">Set up dependencies<a class="headerlink" href="#set-up-dependencies" title="Permanent link">&para;</a></h2>
<ol>
<li>Read <a href="../../download/GeoSpark-All-Modules-Maven-Central-Coordinates/">GeoSpark Maven Central coordinates</a></li>
<li>Select <mark>the minimum dependencies</mark>: Add Apache Spark (only the Spark core) and GeoSpark (core).</li>
<li>Add the dependencies in build.sbt or pom.xml.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To enjoy the full functions of GeoSpark, we suggest you include <mark>the full dependencies</mark>: <a href="https://mvnrepository.com/artifact/org.apache.spark/spark-core_2.11">Apache Spark core</a>, <a href="https://mvnrepository.com/artifact/org.apache.spark/spark-sql">Apache SparkSQL</a>, <a href="../../download/GeoSpark-All-Modules-Maven-Central-Coordinates/#geospark-core">GeoSpark core</a>, <a href="../../download/GeoSpark-All-Modules-Maven-Central-Coordinates/#geospark-sql">GeoSparkSQL</a>, <a href="../../download/GeoSpark-All-Modules-Maven-Central-Coordinates/#geospark-viz">GeoSparkViz</a></p>
</div>
<h2 id="initiate-sparkcontext">Initiate SparkContext<a class="headerlink" href="#initiate-sparkcontext" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">conf</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">SparkConf</span><span class="o">()</span>
<span class="n">conf</span><span class="o">.</span><span class="n">setAppName</span><span class="o">(</span><span class="s">&quot;GeoSparkRunnableExample&quot;</span><span class="o">)</span> <span class="c1">// Change this to a proper name</span>
<span class="n">conf</span><span class="o">.</span><span class="n">setMaster</span><span class="o">(</span><span class="s">&quot;local[*]&quot;</span><span class="o">)</span> <span class="c1">// Delete this if run in cluster mode</span>
<span class="c1">// Enable GeoSpark custom Kryo serializer</span>
<span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="o">(</span><span class="s">&quot;spark.serializer&quot;</span><span class="o">,</span> <span class="n">classOf</span><span class="o">[</span><span class="kt">KryoSerializer</span><span class="o">].</span><span class="n">getName</span><span class="o">)</span>
<span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="o">(</span><span class="s">&quot;spark.kryo.registrator&quot;</span><span class="o">,</span> <span class="n">classOf</span><span class="o">[</span><span class="kt">GeoSparkKryoRegistrator</span><span class="o">].</span><span class="n">getName</span><span class="o">)</span>
<span class="k">val</span> <span class="n">sc</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">SparkContext</span><span class="o">(</span><span class="n">conf</span><span class="o">)</span>
</pre></div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>GeoSpark has a suite of well-written geometry and index serializers. Forgetting to enable these serializers will lead to high memory consumption.</p>
</div>
<p>If you add <mark>the GeoSpark full dependencies</mark> as suggested above, please use the following two lines to enable GeoSpark Kryo serializer instead:
<div class="codehilite"><pre><span></span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="o">(</span><span class="s">&quot;spark.serializer&quot;</span><span class="o">,</span> <span class="n">classOf</span><span class="o">[</span><span class="kt">KryoSerializer</span><span class="o">].</span><span class="n">getName</span><span class="o">)</span>
<span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="o">(</span><span class="s">&quot;spark.kryo.registrator&quot;</span><span class="o">,</span> <span class="n">classOf</span><span class="o">[</span><span class="kt">GeoSparkVizKryoRegistrator</span><span class="o">].</span><span class="n">getName</span><span class="o">)</span>
</pre></div></p>
<h2 id="create-a-spatialrdd">Create a SpatialRDD<a class="headerlink" href="#create-a-spatialrdd" title="Permanent link">&para;</a></h2>
<h3 id="create-a-typed-spatialrdd">Create a typed SpatialRDD<a class="headerlink" href="#create-a-typed-spatialrdd" title="Permanent link">&para;</a></h3>
<p>GeoSpark-core provides three special SpatialRDDs: <mark>PointRDD, PolygonRDD, and LineStringRDD</mark>. They can be loaded from CSV, TSV, WKT, WKB, Shapefiles, GeoJSON and NetCDF/HDF format.</p>
<h4 id="pointrdd-from-csvtsv">PointRDD from CSV/TSV<a class="headerlink" href="#pointrdd-from-csvtsv" title="Permanent link">&para;</a></h4>
<p>Suppose we have a <code class="codehilite">checkin.csv</code> CSV file at Path <code class="codehilite">/Download/checkin.csv</code> as follows:
<div class="codehilite"><pre><span></span>-88.331492,32.324142,hotel
-88.175933,32.360763,gas
-88.388954,32.357073,bar
-88.221102,32.35078,restaurant
</pre></div>
This file has three columns and corresponding <mark>offsets</mark>(Column IDs) are 0, 1, 2.
Use the following code to create a PointRDD</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">pointRDDInputLocation</span> <span class="k">=</span> <span class="s">&quot;/Download/checkin.csv&quot;</span>
<span class="k">val</span> <span class="n">pointRDDOffset</span> <span class="k">=</span> <span class="mi">0</span> <span class="c1">// The point long/lat starts from Column 0</span>
<span class="k">val</span> <span class="n">pointRDDSplitter</span> <span class="k">=</span> <span class="nc">FileDataSplitter</span><span class="o">.</span><span class="nc">CSV</span>
<span class="k">val</span> <span class="n">carryOtherAttributes</span> <span class="k">=</span> <span class="kc">true</span> <span class="c1">// Carry Column 2 (hotel, gas, bar...)</span>
<span class="k">var</span> <span class="n">objectRDD</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PointRDD</span><span class="o">(</span><span class="n">sc</span><span class="o">,</span> <span class="n">pointRDDInputLocation</span><span class="o">,</span> <span class="n">pointRDDOffset</span><span class="o">,</span> <span class="n">pointRDDSplitter</span><span class="o">,</span> <span class="n">carryOtherAttributes</span><span class="o">)</span>
</pre></div>

<p>If the data file is in TSV format, just simply use the following line to replace the old FileDataSplitter:
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">pointRDDSplitter</span> <span class="k">=</span> <span class="nc">FileDataSplitter</span><span class="o">.</span><span class="nc">TSV</span>
</pre></div></p>
<h4 id="polygonrddlinestringrdd-from-csvtsv">PolygonRDD/LineStringRDD from CSV/TSV<a class="headerlink" href="#polygonrddlinestringrdd-from-csvtsv" title="Permanent link">&para;</a></h4>
<p>In general, polygon and line string data is stored in WKT, WKB, GeoJSON and Shapefile formats instead of CSV/TSV because the geometries in a file may have different lengths. However, if all polygons / line strings in your CSV/TSV possess the same length, you can create PolygonRDD and LineStringRDD from these files.</p>
<p>Suppose we have a <code class="codehilite">checkinshape.csv</code> CSV file at Path <code class="codehilite">/Download/checkinshape.csv</code> as follows:
<div class="codehilite"><pre><span></span>-88.331492,32.324142,-88.331492,32.324142,-88.331492,32.324142,-88.331492,32.324142,-88.331492,32.324142,hotel
-88.175933,32.360763,-88.175933,32.360763,-88.175933,32.360763,-88.175933,32.360763,-88.175933,32.360763,gas
-88.388954,32.357073,-88.388954,32.357073,-88.388954,32.357073,-88.388954,32.357073,-88.388954,32.357073,bar
-88.221102,32.35078,-88.221102,32.35078,-88.221102,32.35078,-88.221102,32.35078,-88.221102,32.35078,restaurant
</pre></div></p>
<p>This file has 11 columns and corresponding offsets (Column IDs) are 0 - 10. Column 0 - 9 are 5 coordinates (longitude/latitude pairs). In this file, all geometries have the same number of coordinates. The geometries can be polyons or line strings.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For polygon data, the last coordinate must be the same as the first coordinate because a polygon is a closed linear ring.</p>
</div>
<p>Use the following code to create a PolygonRDD.
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">polygonRDDInputLocation</span> <span class="k">=</span> <span class="s">&quot;/Download/checkinshape.csv&quot;</span>
<span class="k">val</span> <span class="n">polygonRDDStartOffset</span> <span class="k">=</span> <span class="mi">0</span> <span class="c1">// The coordinates start from Column 0</span>
<span class="k">val</span> <span class="n">polygonRDDEndOffset</span> <span class="k">=</span> <span class="mi">9</span> <span class="c1">// The coordinates end at Column 9</span>
<span class="k">val</span> <span class="n">polygonRDDSplitter</span> <span class="k">=</span> <span class="nc">FileDataSplitter</span><span class="o">.</span><span class="nc">CSV</span>
<span class="k">val</span> <span class="n">carryOtherAttributes</span> <span class="k">=</span> <span class="kc">true</span> <span class="c1">// Carry Column 10 (hotel, gas, bar...)</span>
<span class="k">var</span> <span class="n">objectRDD</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PolygonRDD</span><span class="o">(</span><span class="n">sc</span><span class="o">,</span> <span class="n">polygonRDDInputLocation</span><span class="o">,</span> <span class="n">polygonRDDStartOffset</span><span class="o">,</span> <span class="n">polygonRDDEndOffset</span><span class="o">,</span> <span class="n">polygonRDDSplitter</span><span class="o">,</span> <span class="n">carryOtherAttributes</span><span class="o">)</span>
</pre></div></p>
<p>If the data file is in TSV format, just simply use the following line to replace the old FileDataSplitter:
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">polygonRDDSplitter</span> <span class="k">=</span> <span class="nc">FileDataSplitter</span><span class="o">.</span><span class="nc">TSV</span>
</pre></div></p>
<p>The way to create a LineStringRDD is the same as PolygonRDD.</p>
<h3 id="create-a-generic-spatialrdd-behavoir-changed-in-v120">Create a generic SpatialRDD (behavoir changed in v1.2.0)<a class="headerlink" href="#create-a-generic-spatialrdd-behavoir-changed-in-v120" title="Permanent link">&para;</a></h3>
<p>A generic SpatialRDD is not typed to a certain geometry type and open to more scenarios. It allows an input data file contains mixed types of geometries. For instance, a WKT file contains three types gemetries <mark>LineString</mark>, <mark>Polygon</mark> and <mark>MultiPolygon</mark>.</p>
<h4 id="from-wktwkb">From WKT/WKB<a class="headerlink" href="#from-wktwkb" title="Permanent link">&para;</a></h4>
<p>Geometries in a WKT and WKB file always occupy a single column no matter how many coordinates they have. Therefore, creating a typed SpatialRDD is easy.</p>
<p>Suppose we have a <code class="codehilite">checkin.tsv</code> WKT TSV file at Path <code class="codehilite">/Download/checkin.tsv</code> as follows:
<div class="codehilite"><pre><span></span>POINT (-88.331492 32.324142)    hotel
POINT (-88.175933 32.360763)    gas
POINT (-88.388954 32.357073)    bar
POINT (-88.221102 32.35078) restaurant
</pre></div>
This file has two columns and corresponding <mark>offsets</mark>(Column IDs) are 0, 1. Column 0 is the WKT string and Column 1 is the checkin business type.</p>
<p>Use the following code to create a SpatialRDD</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">inputLocation</span> <span class="k">=</span> <span class="s">&quot;/Download/checkin.tsv&quot;</span>
<span class="k">val</span> <span class="n">wktColumn</span> <span class="k">=</span> <span class="mi">0</span> <span class="c1">// The WKT string starts from Column 0</span>
<span class="k">val</span> <span class="n">allowTopologyInvalidGeometries</span> <span class="k">=</span> <span class="kc">true</span> <span class="c1">// Optional</span>
<span class="k">val</span> <span class="n">skipSyntaxInvalidGeometries</span> <span class="k">=</span> <span class="kc">false</span> <span class="c1">// Optional</span>
<span class="k">val</span> <span class="n">spatialRDD</span> <span class="k">=</span> <span class="nc">WktReader</span><span class="o">.</span><span class="n">readToGeometryRDD</span><span class="o">(</span><span class="n">sparkSession</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">,</span> <span class="n">inputLocation</span><span class="o">,</span> <span class="n">wktColumn</span><span class="o">,</span> <span class="n">allowTopologyInvalidGeometries</span><span class="o">,</span> <span class="n">skipSyntaxInvalidGeometries</span><span class="o">)</span>
</pre></div>

<h4 id="from-geojson">From GeoJSON<a class="headerlink" href="#from-geojson" title="Permanent link">&para;</a></h4>
<p>Geometries in GeoJSON is similar to WKT/WKB. However, a GeoJSON file must be beaked into multiple lines.</p>
<p>Suppose we have a <code class="codehilite">polygon.json</code> GeoJSON file at Path <code class="codehilite">/Download/polygon.json</code> as follows:</p>
<div class="codehilite"><pre><span></span>{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;STATEFP&quot;: &quot;01&quot;, &quot;COUNTYFP&quot;: &quot;077&quot;, &quot;TRACTCE&quot;: &quot;011501&quot;, &quot;BLKGRPCE&quot;: &quot;5&quot;, &quot;AFFGEOID&quot;: &quot;1500000US010770115015&quot;, &quot;GEOID&quot;: &quot;010770115015&quot;, &quot;NAME&quot;: &quot;5&quot;, &quot;LSAD&quot;: &quot;BG&quot;, &quot;ALAND&quot;: 6844991, &quot;AWATER&quot;: 32636 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Polygon&quot;, &quot;coordinates&quot;: [ [ [ -87.621765, 34.873444 ], [ -87.617535, 34.873369 ], [ -87.6123, 34.873337 ], [ -87.604049, 34.873303 ], [ -87.604033, 34.872316 ], [ -87.60415, 34.867502 ], [ -87.604218, 34.865687 ], [ -87.604409, 34.858537 ], [ -87.604018, 34.851336 ], [ -87.603716, 34.844829 ], [ -87.603696, 34.844307 ], [ -87.603673, 34.841884 ], [ -87.60372, 34.841003 ], [ -87.603879, 34.838423 ], [ -87.603888, 34.837682 ], [ -87.603889, 34.83763 ], [ -87.613127, 34.833938 ], [ -87.616451, 34.832699 ], [ -87.621041, 34.831431 ], [ -87.621056, 34.831526 ], [ -87.62112, 34.831925 ], [ -87.621603, 34.8352 ], [ -87.62158, 34.836087 ], [ -87.621383, 34.84329 ], [ -87.621359, 34.844438 ], [ -87.62129, 34.846387 ], [ -87.62119, 34.85053 ], [ -87.62144, 34.865379 ], [ -87.621765, 34.873444 ] ] ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;STATEFP&quot;: &quot;01&quot;, &quot;COUNTYFP&quot;: &quot;045&quot;, &quot;TRACTCE&quot;: &quot;021102&quot;, &quot;BLKGRPCE&quot;: &quot;4&quot;, &quot;AFFGEOID&quot;: &quot;1500000US010450211024&quot;, &quot;GEOID&quot;: &quot;010450211024&quot;, &quot;NAME&quot;: &quot;4&quot;, &quot;LSAD&quot;: &quot;BG&quot;, &quot;ALAND&quot;: 11360854, &quot;AWATER&quot;: 0 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Polygon&quot;, &quot;coordinates&quot;: [ [ [ -85.719017, 31.297901 ], [ -85.715626, 31.305203 ], [ -85.714271, 31.307096 ], [ -85.69999, 31.307552 ], [ -85.697419, 31.307951 ], [ -85.675603, 31.31218 ], [ -85.672733, 31.312876 ], [ -85.672275, 31.311977 ], [ -85.67145, 31.310988 ], [ -85.670622, 31.309524 ], [ -85.670729, 31.307622 ], [ -85.669876, 31.30666 ], [ -85.669796, 31.306224 ], [ -85.670356, 31.306178 ], [ -85.671664, 31.305583 ], [ -85.67177, 31.305299 ], [ -85.671878, 31.302764 ], [ -85.671344, 31.302123 ], [ -85.668276, 31.302076 ], [ -85.66566, 31.30093 ], [ -85.665687, 31.30022 ], [ -85.669183, 31.297677 ], [ -85.668703, 31.295638 ], [ -85.671985, 31.29314 ], [ -85.677177, 31.288211 ], [ -85.678452, 31.286376 ], [ -85.679236, 31.28285 ], [ -85.679195, 31.281426 ], [ -85.676865, 31.281049 ], [ -85.674661, 31.28008 ], [ -85.674377, 31.27935 ], [ -85.675714, 31.276882 ], [ -85.677938, 31.275168 ], [ -85.680348, 31.276814 ], [ -85.684032, 31.278848 ], [ -85.684387, 31.279082 ], [ -85.692398, 31.283499 ], [ -85.705032, 31.289718 ], [ -85.706755, 31.290476 ], [ -85.718102, 31.295204 ], [ -85.719132, 31.29689 ], [ -85.719017, 31.297901 ] ] ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;STATEFP&quot;: &quot;01&quot;, &quot;COUNTYFP&quot;: &quot;055&quot;, &quot;TRACTCE&quot;: &quot;001300&quot;, &quot;BLKGRPCE&quot;: &quot;3&quot;, &quot;AFFGEOID&quot;: &quot;1500000US010550013003&quot;, &quot;GEOID&quot;: &quot;010550013003&quot;, &quot;NAME&quot;: &quot;3&quot;, &quot;LSAD&quot;: &quot;BG&quot;, &quot;ALAND&quot;: 1378742, &quot;AWATER&quot;: 247387 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Polygon&quot;, &quot;coordinates&quot;: [ [ [ -86.000685, 34.00537 ], [ -85.998837, 34.009768 ], [ -85.998012, 34.010398 ], [ -85.987865, 34.005426 ], [ -85.986656, 34.004552 ], [ -85.985, 34.002659 ], [ -85.98851, 34.001502 ], [ -85.987567, 33.999488 ], [ -85.988666, 33.99913 ], [ -85.992568, 33.999131 ], [ -85.993144, 33.999714 ], [ -85.994876, 33.995153 ], [ -85.998823, 33.989548 ], [ -85.999925, 33.994237 ], [ -86.000616, 34.000028 ], [ -86.000685, 34.00537 ] ] ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;STATEFP&quot;: &quot;01&quot;, &quot;COUNTYFP&quot;: &quot;089&quot;, &quot;TRACTCE&quot;: &quot;001700&quot;, &quot;BLKGRPCE&quot;: &quot;2&quot;, &quot;AFFGEOID&quot;: &quot;1500000US010890017002&quot;, &quot;GEOID&quot;: &quot;010890017002&quot;, &quot;NAME&quot;: &quot;2&quot;, &quot;LSAD&quot;: &quot;BG&quot;, &quot;ALAND&quot;: 1040641, &quot;AWATER&quot;: 0 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Polygon&quot;, &quot;coordinates&quot;: [ [ [ -86.574172, 34.727375 ], [ -86.562684, 34.727131 ], [ -86.562797, 34.723865 ], [ -86.562957, 34.723168 ], [ -86.562336, 34.719766 ], [ -86.557381, 34.719143 ], [ -86.557352, 34.718322 ], [ -86.559921, 34.717363 ], [ -86.564827, 34.718513 ], [ -86.567582, 34.718565 ], [ -86.570572, 34.718577 ], [ -86.573618, 34.719377 ], [ -86.574172, 34.727375 ] ] ] } },
</pre></div>

<p>Use the following code to create a generic SpatialRDD:
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">inputLocation</span> <span class="k">=</span> <span class="s">&quot;/Download/polygon.json&quot;</span>
<span class="k">val</span> <span class="n">allowTopologyInvalidGeometries</span> <span class="k">=</span> <span class="kc">true</span> <span class="c1">// Optional</span>
<span class="k">val</span> <span class="n">skipSyntaxInvalidGeometries</span> <span class="k">=</span> <span class="kc">false</span> <span class="c1">// Optional</span>
<span class="k">val</span> <span class="n">spatialRDD</span> <span class="k">=</span> <span class="nc">GeoJsonReader</span><span class="o">.</span><span class="n">readToGeometryRDD</span><span class="o">(</span><span class="n">sparkSession</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">,</span> <span class="n">inputLocation</span><span class="o">,</span> <span class="n">allowTopologyInvalidGeometries</span><span class="o">,</span> <span class="n">skipSyntaxInvalidGeometries</span><span class="o">)</span>
</pre></div></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The way that GeoSpark reads JSON file is different from SparkSQL</p>
</div>
<h4 id="from-shapefile">From Shapefile<a class="headerlink" href="#from-shapefile" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">shapefileInputLocation</span><span class="o">=</span><span class="s">&quot;/Download/myshapefile&quot;</span>
<span class="k">val</span> <span class="n">spatialRDD</span> <span class="k">=</span> <span class="nc">ShapefileReader</span><span class="o">.</span><span class="n">readToGeometryRDD</span><span class="o">(</span><span class="n">sparkSession</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">,</span> <span class="n">shapefileInputLocation</span><span class="o">)</span>
</pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The file extensions of .shp, .shx, .dbf must be in lowercase. Assume you have a shape file called <mark>myShapefile</mark>, the file structure should be like this:
<div class="codehilite"><pre><span></span>- shapefile1
- shapefile2
- myshapefile
    - myshapefile.shp
    - myshapefile.shx
    - myshapefile.dbf
    - myshapefile...
    - ...
</pre></div></p>
</div>
<p>If the file you are reading contains non-ASCII characters you'll need to explicitly set the encoding
via <code class="codehilite">geospark.global.charset</code> system property before the call to <code class="codehilite">ShapefileReader.readToGeometryRDD</code>.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><span class="nc">System</span><span class="o">.</span><span class="n">setProperty</span><span class="o">(</span><span class="s">&quot;geospark.global.charset&quot;</span><span class="o">,</span> <span class="s">&quot;utf8&quot;</span><span class="o">)</span>
</pre></div>

<h4 id="from-sparksql-dataframe">From SparkSQL DataFrame<a class="headerlink" href="#from-sparksql-dataframe" title="Permanent link">&para;</a></h4>
<p>To create a generic SpatialRDD from CSV, TSV, WKT, WKB and GeoJSON input formats, you can use GeoSparkSQL. Make sure you include <mark>the full dependencies</mark> of GeoSpark. Read <a href="../../api/sql/GeoSparkSQL-Overview">GeoSparkSQL API</a>.</p>
<p>We use <a href="#pointrdd-from-csvtsv">checkin.csv CSV file</a> as the example. You can create a generic SpatialRDD using the following steps:</p>
<ol>
<li>Load data in GeoSparkSQL.
<div class="codehilite"><pre><span></span><span class="k">var</span> <span class="n">df</span> <span class="k">=</span> <span class="n">sparkSession</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="s">&quot;csv&quot;</span><span class="o">).</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;header&quot;</span><span class="o">,</span> <span class="s">&quot;false&quot;</span><span class="o">).</span><span class="n">load</span><span class="o">(</span><span class="n">csvPointInputLocation</span><span class="o">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="o">(</span><span class="s">&quot;inputtable&quot;</span><span class="o">)</span>
</pre></div></li>
<li>Create a Geometry type column in GeoSparkSQL
<div class="codehilite"><pre><span></span><span class="k">var</span> <span class="n">spatialDf</span> <span class="k">=</span> <span class="n">sparkSession</span><span class="o">.</span><span class="n">sql</span><span class="o">(</span>
    <span class="s">&quot;&quot;&quot;</span>
<span class="s">        |SELECT ST_Point(CAST(inputtable._c0 AS Decimal(24,20)),CAST(inputtable._c1 AS Decimal(24,20))) AS checkin</span>
<span class="s">        |FROM inputtable</span>
<span class="s">    &quot;&quot;&quot;</span><span class="o">.</span><span class="n">stripMargin</span><span class="o">)</span>
</pre></div></li>
<li>Use GeoSparkSQL DataFrame-RDD Adapter to convert a DataFrame to an SpatialRDD
<div class="codehilite"><pre><span></span><span class="k">var</span> <span class="n">spatialRDD</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">SpatialRDD</span><span class="o">[</span><span class="kt">Geometry</span><span class="o">]</span>
<span class="n">spatialRDD</span><span class="o">.</span><span class="n">rawSpatialRDD</span> <span class="k">=</span> <span class="nc">Adapter</span><span class="o">.</span><span class="n">toRdd</span><span class="o">(</span><span class="n">spatialDf</span><span class="o">)</span>
</pre></div></li>
</ol>
<p>For WKT/WKB/GeoJSON data, please use <mark>ST_GeomFromWKT / ST_GeomFromWKB / ST_GeomFromGeoJSON</mark> instead.</p>
<h2 id="transform-the-coordinate-reference-system">Transform the Coordinate Reference System<a class="headerlink" href="#transform-the-coordinate-reference-system" title="Permanent link">&para;</a></h2>
<p>GeoSpark doesn't control the coordinate unit (degree-based or meter-based) of all geometries in an SpatialRDD. The unit of all related distances in GeoSpark is same as the unit of all geometries in an SpatialRDD.</p>
<p>To convert Coordinate Reference System of an SpatialRDD, use the following code:</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">sourceCrsCode</span> <span class="k">=</span> <span class="s">&quot;epsg:4326&quot;</span> <span class="c1">// WGS84, the most common degree-based CRS</span>
<span class="k">val</span> <span class="n">targetCrsCode</span> <span class="k">=</span> <span class="s">&quot;epsg:3857&quot;</span> <span class="c1">// The most common meter-based CRS</span>
<span class="n">objectRDD</span><span class="o">.</span><span class="nc">CRSTransform</span><span class="o">(</span><span class="n">sourceCrsCode</span><span class="o">,</span> <span class="n">targetCrsCode</span><span class="o">)</span>
</pre></div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>CRS transformation should be done right after creating each SpatialRDD, otherwise it will lead to wrong query results. For instace, use something like this:
<div class="codehilite"><pre><span></span><span class="k">var</span> <span class="n">objectRDD</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PointRDD</span><span class="o">(</span><span class="n">sc</span><span class="o">,</span> <span class="n">pointRDDInputLocation</span><span class="o">,</span> <span class="n">pointRDDOffset</span><span class="o">,</span> <span class="n">pointRDDSplitter</span><span class="o">,</span> <span class="n">carryOtherAttributes</span><span class="o">)</span>
<span class="n">objectRDD</span><span class="o">.</span><span class="nc">CRSTransform</span><span class="o">(</span><span class="s">&quot;epsg:4326&quot;</span><span class="o">,</span> <span class="s">&quot;epsg:3857&quot;</span><span class="o">)</span>
</pre></div></p>
</div>
<p>The details CRS information can be found on <a href="https://epsg.io/.">EPSG.io</a></p>
<h2 id="read-other-attributes-in-an-spatialrdd">Read other attributes in an SpatialRDD<a class="headerlink" href="#read-other-attributes-in-an-spatialrdd" title="Permanent link">&para;</a></h2>
<p>Each SpatialRDD can carry non-spatial attributes such as price, age and name as long as the user sets <mark>carryOtherAttributes</mark> as <a href="#create-a-spatialrdd">TRUE</a>.</p>
<p>The other attributes are combined together to a string and stored in <mark>UserData</mark> field of each geometry.</p>
<p>To retrieve the UserData field, use the following code:
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">rddWithOtherAttributes</span> <span class="k">=</span> <span class="n">objectRDD</span><span class="o">.</span><span class="n">rawSpatialRDD</span><span class="o">.</span><span class="n">rdd</span><span class="o">.</span><span class="n">map</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="n">f</span><span class="k">=&gt;</span><span class="n">f</span><span class="o">.</span><span class="n">getUserData</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span>
</pre></div></p>
<h2 id="write-a-spatial-range-query">Write a Spatial Range Query<a class="headerlink" href="#write-a-spatial-range-query" title="Permanent link">&para;</a></h2>
<p>A spatial range query takes as input a range query window and an SpatialRDD and returns all geometries that intersect / are fully covered by the query window.</p>
<p>Assume you now have an SpatialRDD (typed or generic). You can use the following code to issue an Spatial Range Query on it.</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">rangeQueryWindow</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Envelope</span><span class="o">(-</span><span class="mf">90.01</span><span class="o">,</span> <span class="o">-</span><span class="mf">80.01</span><span class="o">,</span> <span class="mf">30.01</span><span class="o">,</span> <span class="mf">40.01</span><span class="o">)</span>
<span class="k">val</span> <span class="n">considerBoundaryIntersection</span> <span class="k">=</span> <span class="kc">false</span> <span class="c1">// Only return gemeotries fully covered by the window</span>
<span class="k">val</span> <span class="n">usingIndex</span> <span class="k">=</span> <span class="kc">false</span>
<span class="k">var</span> <span class="n">queryResult</span> <span class="k">=</span> <span class="nc">RangeQuery</span><span class="o">.</span><span class="nc">SpatialRangeQuery</span><span class="o">(</span><span class="n">spatialRDD</span><span class="o">,</span> <span class="n">rangeQueryWindow</span><span class="o">,</span> <span class="n">considerBoundaryIntersection</span><span class="o">,</span> <span class="n">usingIndex</span><span class="o">)</span>
</pre></div>

<p><mark>considerBoundaryIntersection</mark> can be set to TRUE to return all geometries intersect with query window.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Spatial range query is equal to <mark>ST_Within</mark> and <mark>ST_Intersects</mark> in Spatial SQL. An example query is as follows:
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">checkin</span>
<span class="k">WHERE</span> <span class="n">ST_Intersects</span><span class="p">(</span><span class="n">queryWindow</span><span class="p">,</span> <span class="n">checkin</span><span class="p">.</span><span class="k">location</span><span class="p">)</span>
</pre></div></p>
</div>
<h3 id="range-query-window">Range query window<a class="headerlink" href="#range-query-window" title="Permanent link">&para;</a></h3>
<p>Besides the rectangle (Envelope) type range query window, GeoSpark range query window can be Point/Polygon/LineString.</p>
<p>The code to create a point is as follows:</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">geometryFactory</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">GeometryFactory</span><span class="o">()</span>
<span class="k">val</span> <span class="n">pointObject</span> <span class="k">=</span> <span class="n">geometryFactory</span><span class="o">.</span><span class="n">createPoint</span><span class="o">(</span><span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(-</span><span class="mf">84.01</span><span class="o">,</span> <span class="mf">34.01</span><span class="o">))</span>
</pre></div>

<p>The code to create a polygon (with 4 vertexes) is as follows:</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">geometryFactory</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">GeometryFactory</span><span class="o">()</span>
<span class="k">val</span> <span class="n">coordinates</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Array</span><span class="o">[</span><span class="kt">Coordinate</span><span class="o">](</span><span class="mi">5</span><span class="o">)</span>
<span class="n">coordinates</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">)</span>
<span class="n">coordinates</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">4</span><span class="o">)</span>
<span class="n">coordinates</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span><span class="mi">4</span><span class="o">)</span>
<span class="n">coordinates</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span><span class="mi">0</span><span class="o">)</span>
<span class="n">coordinates</span><span class="o">(</span><span class="mi">4</span><span class="o">)</span> <span class="k">=</span> <span class="n">coordinates</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="c1">// The last coordinate is the same as the first coordinate in order to compose a closed ring</span>
<span class="k">val</span> <span class="n">polygonObject</span> <span class="k">=</span> <span class="n">geometryFactory</span><span class="o">.</span><span class="n">createPolygon</span><span class="o">(</span><span class="n">coordinates</span><span class="o">)</span>
</pre></div>

<p>The code to create a line string (with 4 vertexes) is as follows:</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">geometryFactory</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">GeometryFactory</span><span class="o">()</span>
<span class="k">val</span> <span class="n">coordinates</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Array</span><span class="o">[</span><span class="kt">Coordinate</span><span class="o">](</span><span class="mi">4</span><span class="o">)</span>
<span class="n">coordinates</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">)</span>
<span class="n">coordinates</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">4</span><span class="o">)</span>
<span class="n">coordinates</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span><span class="mi">4</span><span class="o">)</span>
<span class="n">coordinates</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span><span class="mi">0</span><span class="o">)</span>
<span class="k">val</span> <span class="n">linestringObject</span> <span class="k">=</span> <span class="n">geometryFactory</span><span class="o">.</span><span class="n">createLineString</span><span class="o">(</span><span class="n">coordinates</span><span class="o">)</span>
</pre></div>

<h3 id="use-spatial-indexes">Use spatial indexes<a class="headerlink" href="#use-spatial-indexes" title="Permanent link">&para;</a></h3>
<p>GeoSpark provides two types of spatial indexes, Quad-Tree and R-Tree. Once you specify an index type, GeoSpark will build a local tree index on each of the SpatialRDD partition.</p>
<p>To utilize a spatial index in a spatial range query, use the following code:</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">rangeQueryWindow</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Envelope</span><span class="o">(-</span><span class="mf">90.01</span><span class="o">,</span> <span class="o">-</span><span class="mf">80.01</span><span class="o">,</span> <span class="mf">30.01</span><span class="o">,</span> <span class="mf">40.01</span><span class="o">)</span>
<span class="k">val</span> <span class="n">considerBoundaryIntersection</span> <span class="k">=</span> <span class="kc">false</span> <span class="c1">// Only return gemeotries fully covered by the window</span>

<span class="k">val</span> <span class="n">buildOnSpatialPartitionedRDD</span> <span class="k">=</span> <span class="kc">false</span> <span class="c1">// Set to TRUE only if run join query</span>
<span class="n">spatialRDD</span><span class="o">.</span><span class="n">buildIndex</span><span class="o">(</span><span class="nc">IndexType</span><span class="o">.</span><span class="nc">QUADTREE</span><span class="o">,</span> <span class="n">buildOnSpatialPartitionedRDD</span><span class="o">)</span>

<span class="k">val</span> <span class="n">usingIndex</span> <span class="k">=</span> <span class="kc">true</span>
<span class="k">var</span> <span class="n">queryResult</span> <span class="k">=</span> <span class="nc">RangeQuery</span><span class="o">.</span><span class="nc">SpatialRangeQuery</span><span class="o">(</span><span class="n">spatialRDD</span><span class="o">,</span> <span class="n">rangeQueryWindow</span><span class="o">,</span> <span class="n">considerBoundaryIntersection</span><span class="o">,</span> <span class="n">usingIndex</span><span class="o">)</span>
</pre></div>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Using an index might not be the best choice all the time because building index also takes time. A spatial index is very useful when your data is complex polygons and line strings.</p>
</div>
<h3 id="output-format">Output format<a class="headerlink" href="#output-format" title="Permanent link">&para;</a></h3>
<p>The output format of the spatial range query is another SpatialRDD.</p>
<h2 id="write-a-spatial-knn-query">Write a Spatial KNN Query<a class="headerlink" href="#write-a-spatial-knn-query" title="Permanent link">&para;</a></h2>
<p>A spatial K Nearnest Neighbor query takes as input a K, a query point and an SpatialRDD and finds the K geometries in the RDD which are the closest to he query point.</p>
<p>Assume you now have an SpatialRDD (typed or generic). You can use the following code to issue an Spatial KNN Query on it.</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">geometryFactory</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">GeometryFactory</span><span class="o">()</span>
<span class="k">val</span> <span class="n">pointObject</span> <span class="k">=</span> <span class="n">geometryFactory</span><span class="o">.</span><span class="n">createPoint</span><span class="o">(</span><span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(-</span><span class="mf">84.01</span><span class="o">,</span> <span class="mf">34.01</span><span class="o">))</span>
<span class="k">val</span> <span class="n">K</span> <span class="k">=</span> <span class="mi">1000</span> <span class="c1">// K Nearest Neighbors</span>
<span class="k">val</span> <span class="n">usingIndex</span> <span class="k">=</span> <span class="kc">false</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="nc">KNNQuery</span><span class="o">.</span><span class="nc">SpatialKnnQuery</span><span class="o">(</span><span class="n">objectRDD</span><span class="o">,</span> <span class="n">pointObject</span><span class="o">,</span> <span class="n">K</span><span class="o">,</span> <span class="n">usingIndex</span><span class="o">)</span>
</pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Spatial KNN query that returns 5 Nearest Neighbors is equal to the following statement in Spatial SQL
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">ck</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ck</span><span class="p">.</span><span class="n">rating</span><span class="p">,</span> <span class="n">ST_Distance</span><span class="p">(</span><span class="n">ck</span><span class="p">.</span><span class="k">location</span><span class="p">,</span> <span class="n">myLocation</span><span class="p">)</span> <span class="k">AS</span> <span class="n">distance</span>
<span class="k">FROM</span> <span class="n">checkins</span> <span class="n">ck</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">distance</span> <span class="k">DESC</span>
<span class="k">LIMIT</span> <span class="mi">5</span>
</pre></div></p>
</div>
<h3 id="query-center-geometry">Query center geometry<a class="headerlink" href="#query-center-geometry" title="Permanent link">&para;</a></h3>
<p>Besides the Point type, GeoSpark KNN query center can be Polygon and LineString.</p>
<p>To learn how to create Polygon and LineString object, see <a href="#range-query-window">Range query window</a>.</p>
<h3 id="use-spatial-indexes_1">Use spatial indexes<a class="headerlink" href="#use-spatial-indexes_1" title="Permanent link">&para;</a></h3>
<p>To utilize a spatial index in a spatial KNN query, use the following code:</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">geometryFactory</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">GeometryFactory</span><span class="o">()</span>
<span class="k">val</span> <span class="n">pointObject</span> <span class="k">=</span> <span class="n">geometryFactory</span><span class="o">.</span><span class="n">createPoint</span><span class="o">(</span><span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(-</span><span class="mf">84.01</span><span class="o">,</span> <span class="mf">34.01</span><span class="o">))</span>
<span class="k">val</span> <span class="n">K</span> <span class="k">=</span> <span class="mi">1000</span> <span class="c1">// K Nearest Neighbors</span>


<span class="k">val</span> <span class="n">buildOnSpatialPartitionedRDD</span> <span class="k">=</span> <span class="kc">false</span> <span class="c1">// Set to TRUE only if run join query</span>
<span class="n">objectRDD</span><span class="o">.</span><span class="n">buildIndex</span><span class="o">(</span><span class="nc">IndexType</span><span class="o">.</span><span class="nc">RTREE</span><span class="o">,</span> <span class="n">buildOnSpatialPartitionedRDD</span><span class="o">)</span>

<span class="k">val</span> <span class="n">usingIndex</span> <span class="k">=</span> <span class="kc">true</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="nc">KNNQuery</span><span class="o">.</span><span class="nc">SpatialKnnQuery</span><span class="o">(</span><span class="n">objectRDD</span><span class="o">,</span> <span class="n">pointObject</span><span class="o">,</span> <span class="n">K</span><span class="o">,</span> <span class="n">usingIndex</span><span class="o">)</span>
</pre></div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only R-Tree index supports Spatial KNN query</p>
</div>
<h3 id="output-format_1">Output format<a class="headerlink" href="#output-format_1" title="Permanent link">&para;</a></h3>
<p>The output format of the spatial KNN query is a list of geometries. The list has K geometry objects.</p>
<h2 id="write-a-spatial-join-query">Write a Spatial Join Query<a class="headerlink" href="#write-a-spatial-join-query" title="Permanent link">&para;</a></h2>
<p>A spatial join query takes as input two Spatial RDD A and B. For each geometry in A, finds the geometries (from B) covered/intersected by it. A and B can be any geometry type and are not necessary to have the same geometry type.</p>
<p>Assume you now have two SpatialRDDs (typed or generic). You can use the following code to issue an Spatial Join Query on them.</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">considerBoundaryIntersection</span> <span class="k">=</span> <span class="kc">false</span> <span class="c1">// Only return gemeotries fully covered by each query window in queryWindowRDD</span>
<span class="k">val</span> <span class="n">usingIndex</span> <span class="k">=</span> <span class="kc">false</span>

<span class="n">objectRDD</span><span class="o">.</span><span class="n">analyze</span><span class="o">()</span>

<span class="n">objectRDD</span><span class="o">.</span><span class="n">spatialPartitioning</span><span class="o">(</span><span class="nc">GridType</span><span class="o">.</span><span class="nc">KDBTREE</span><span class="o">)</span>
<span class="n">queryWindowRDD</span><span class="o">.</span><span class="n">spatialPartitioning</span><span class="o">(</span><span class="n">objectRDD</span><span class="o">.</span><span class="n">getPartitioner</span><span class="o">)</span>

<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="nc">JoinQuery</span><span class="o">.</span><span class="nc">SpatialJoinQuery</span><span class="o">(</span><span class="n">objectRDD</span><span class="o">,</span> <span class="n">queryWindowRDD</span><span class="o">,</span> <span class="n">usingIndex</span><span class="o">,</span> <span class="n">considerBoundaryIntersection</span><span class="o">)</span>
</pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Spatial join query is equal to the following query in Spatial SQL:
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">superhero</span><span class="p">.</span><span class="n">name</span>
<span class="k">FROM</span> <span class="n">city</span><span class="p">,</span> <span class="n">superhero</span>
<span class="k">WHERE</span> <span class="n">ST_Contains</span><span class="p">(</span><span class="n">city</span><span class="p">.</span><span class="n">geom</span><span class="p">,</span> <span class="n">superhero</span><span class="p">.</span><span class="n">geom</span><span class="p">);</span>
</pre></div>
Find the super heros in each city</p>
</div>
<h3 id="use-spatial-partitioning">Use spatial partitioning<a class="headerlink" href="#use-spatial-partitioning" title="Permanent link">&para;</a></h3>
<p>GeoSpark spatial partitioning method can significantly speed up the join query. Three spatial partitioning methods are available: KDB-Tree, Quad-Tree and R-Tree. Two SpatialRDD must be partitioned by the same way.</p>
<p>If you first partition SpatialRDD A, then you must use the partitioner of A to partition B.</p>
<div class="codehilite"><pre><span></span><span class="n">objectRDD</span><span class="o">.</span><span class="n">spatialPartitioning</span><span class="o">(</span><span class="nc">GridType</span><span class="o">.</span><span class="nc">KDBTREE</span><span class="o">)</span>
<span class="n">queryWindowRDD</span><span class="o">.</span><span class="n">spatialPartitioning</span><span class="o">(</span><span class="n">objectRDD</span><span class="o">.</span><span class="n">getPartitioner</span><span class="o">)</span>
</pre></div>

<p>Or </p>
<div class="codehilite"><pre><span></span><span class="n">queryWindowRDD</span><span class="o">.</span><span class="n">spatialPartitioning</span><span class="o">(</span><span class="nc">GridType</span><span class="o">.</span><span class="nc">KDBTREE</span><span class="o">)</span>
<span class="n">objectRDD</span><span class="o">.</span><span class="n">spatialPartitioning</span><span class="o">(</span><span class="n">queryWindowRDD</span><span class="o">.</span><span class="n">getPartitioner</span><span class="o">)</span>
</pre></div>

<h3 id="use-spatial-indexes_2">Use spatial indexes<a class="headerlink" href="#use-spatial-indexes_2" title="Permanent link">&para;</a></h3>
<p>To utilize a spatial index in a spatial join query, use the following code:</p>
<div class="codehilite"><pre><span></span><span class="n">objectRDD</span><span class="o">.</span><span class="n">spatialPartitioning</span><span class="o">(</span><span class="n">joinQueryPartitioningType</span><span class="o">)</span>
<span class="n">queryWindowRDD</span><span class="o">.</span><span class="n">spatialPartitioning</span><span class="o">(</span><span class="n">objectRDD</span><span class="o">.</span><span class="n">getPartitioner</span><span class="o">)</span>

<span class="k">val</span> <span class="n">buildOnSpatialPartitionedRDD</span> <span class="k">=</span> <span class="kc">true</span> <span class="c1">// Set to TRUE only if run join query</span>
<span class="k">val</span> <span class="n">usingIndex</span> <span class="k">=</span> <span class="kc">true</span>
<span class="n">queryWindowRDD</span><span class="o">.</span><span class="n">buildIndex</span><span class="o">(</span><span class="nc">IndexType</span><span class="o">.</span><span class="nc">QUADTREE</span><span class="o">,</span> <span class="n">buildOnSpatialPartitionedRDD</span><span class="o">)</span>

<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="nc">JoinQuery</span><span class="o">.</span><span class="nc">SpatialJoinQueryFlat</span><span class="o">(</span><span class="n">objectRDD</span><span class="o">,</span> <span class="n">queryWindowRDD</span><span class="o">,</span> <span class="n">usingIndex</span><span class="o">,</span> <span class="n">considerBoundaryIntersection</span><span class="o">)</span>
</pre></div>

<p>The index should be built on either one of two SpatialRDDs. In general, you should build it on the larger SpatialRDD.</p>
<h3 id="output-format_2">Output format<a class="headerlink" href="#output-format_2" title="Permanent link">&para;</a></h3>
<p>The output format of the spatial join query is a PairRDD. In this PairRDD, each object is a pair of two geometries. The left one is the geometry from objectRDD and the right one is the geometry from the queryWindowRDD.</p>
<div class="codehilite"><pre><span></span>Point,Polygon
Point,Polygon
Point,Polygon
Polygon,Polygon
LineString,LineString
Polygon,LineString
...
</pre></div>

<p>Each object on the left is covered/intersected by the object on the right.</p>
<h2 id="write-a-distance-join-query">Write a Distance Join Query<a class="headerlink" href="#write-a-distance-join-query" title="Permanent link">&para;</a></h2>
<p>A distance join query takes as input two Spatial RDD A and B and a distance. For each geometry in A, finds the geometries (from B) are within the given distance to it. A and B can be any geometry type and are not necessary to have the same geometry type. The unit of the distance is explained <a href="#transform-the-coordinate-reference-system">here</a>.</p>
<p>Assume you now have two SpatialRDDs (typed or generic). You can use the following code to issue an Distance Join Query on them.</p>
<div class="codehilite"><pre><span></span><span class="n">objectRddA</span><span class="o">.</span><span class="n">analyze</span><span class="o">()</span>

<span class="k">val</span> <span class="n">circleRDD</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">CircleRDD</span><span class="o">(</span><span class="n">objectRddA</span><span class="o">,</span> <span class="mf">0.1</span><span class="o">)</span> <span class="c1">// Create a CircleRDD using the given distance</span>

<span class="n">circleRDD</span><span class="o">.</span><span class="n">spatialPartitioning</span><span class="o">(</span><span class="nc">GridType</span><span class="o">.</span><span class="nc">KDBTREE</span><span class="o">)</span>
<span class="n">objectRddB</span><span class="o">.</span><span class="n">spatialPartitioning</span><span class="o">(</span><span class="n">circleRDD</span><span class="o">.</span><span class="n">getPartitioner</span><span class="o">)</span>

<span class="k">val</span> <span class="n">considerBoundaryIntersection</span> <span class="k">=</span> <span class="kc">false</span> <span class="c1">// Only return gemeotries fully covered by each query window in queryWindowRDD</span>
<span class="k">val</span> <span class="n">usingIndex</span> <span class="k">=</span> <span class="kc">false</span>

<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="nc">JoinQuery</span><span class="o">.</span><span class="nc">DistanceJoinQueryFlat</span><span class="o">(</span><span class="n">objectRddB</span><span class="o">,</span> <span class="n">circleRDD</span><span class="o">,</span> <span class="n">usingIndex</span><span class="o">,</span> <span class="n">considerBoundaryIntersection</span><span class="o">)</span>
</pre></div>

<p>The rest part of the join query is same as the spatial join query.</p>
<p>The details of spatial partitioning in join query is <a href="#use-spatial-partitioning">here</a>.</p>
<p>The details of using spatial indexes in join query is <a href="#use-spatial-indexes_2">here</a>.</p>
<p>The output format of the distance join query is <a href="#output-format_2">here</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Distance join query is equal to the following query in Spatial SQL:
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">superhero</span><span class="p">.</span><span class="n">name</span>
<span class="k">FROM</span> <span class="n">city</span><span class="p">,</span> <span class="n">superhero</span>
<span class="k">WHERE</span> <span class="n">ST_Distance</span><span class="p">(</span><span class="n">city</span><span class="p">.</span><span class="n">geom</span><span class="p">,</span> <span class="n">superhero</span><span class="p">.</span><span class="n">geom</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">;</span>
</pre></div>
Find the super heros within 10 miles of each city</p>
</div>
<h2 id="save-to-permanent-storage">Save to permanent storage<a class="headerlink" href="#save-to-permanent-storage" title="Permanent link">&para;</a></h2>
<p>You can always save an SpatialRDD back to some permanent storage such as HDFS and Amazon S3. You can save distributed SpatialRDD to WKT, GeoJSON and object files.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Non-spatial attributes such as price, age and name will also be stored to permanent storage.</p>
</div>
<h3 id="save-an-spatialrdd-not-indexed">Save an SpatialRDD (not indexed)<a class="headerlink" href="#save-an-spatialrdd-not-indexed" title="Permanent link">&para;</a></h3>
<p>Typed SpatialRDD and generic SpatialRDD can be saved to permanent storage.</p>
<h4 id="save-to-distributed-wkt-text-file">Save to distributed WKT text file<a class="headerlink" href="#save-to-distributed-wkt-text-file" title="Permanent link">&para;</a></h4>
<p>Use the following code to save an SpatialRDD as a distributed WKT text file:</p>
<div class="codehilite"><pre><span></span><span class="n">objectRDD</span><span class="o">.</span><span class="n">rawSpatialRDD</span><span class="o">.</span><span class="n">saveAsTextFile</span><span class="o">(</span><span class="s">&quot;hdfs://PATH&quot;</span><span class="o">)</span>
<span class="n">objectRDD</span><span class="o">.</span><span class="n">saveAsWKT</span><span class="o">(</span><span class="s">&quot;hdfs://PATH&quot;</span><span class="o">)</span>
</pre></div>

<h4 id="save-to-distributed-wkb-text-file">Save to distributed WKB text file<a class="headerlink" href="#save-to-distributed-wkb-text-file" title="Permanent link">&para;</a></h4>
<p>Use the following code to save an SpatialRDD as a distributed WKB text file:</p>
<div class="codehilite"><pre><span></span><span class="n">objectRDD</span><span class="o">.</span><span class="n">saveAsWKB</span><span class="o">(</span><span class="s">&quot;hdfs://PATH&quot;</span><span class="o">)</span>
</pre></div>

<h4 id="save-to-distributed-geojson-text-file">Save to distributed GeoJSON text file<a class="headerlink" href="#save-to-distributed-geojson-text-file" title="Permanent link">&para;</a></h4>
<p>Use the following code to save an SpatialRDD as a distributed GeoJSON text file:</p>
<div class="codehilite"><pre><span></span><span class="n">objectRDD</span><span class="o">.</span><span class="n">saveAsGeoJSON</span><span class="o">(</span><span class="s">&quot;hdfs://PATH&quot;</span><span class="o">)</span>
</pre></div>

<h4 id="save-to-distributed-object-file">Save to distributed object file<a class="headerlink" href="#save-to-distributed-object-file" title="Permanent link">&para;</a></h4>
<p>Use the following code to save an SpatialRDD as a distributed object file:</p>
<div class="codehilite"><pre><span></span><span class="n">objectRDD</span><span class="o">.</span><span class="n">rawSpatialRDD</span><span class="o">.</span><span class="n">saveAsObjectFile</span><span class="o">(</span><span class="s">&quot;hdfs://PATH&quot;</span><span class="o">)</span>
</pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each object in a distributed object file is a byte array (not human-readable). This byte array is the serialized format of a Geometry or a SpatialIndex.</p>
</div>
<h3 id="save-an-spatialrdd-indexed">Save an SpatialRDD (indexed)<a class="headerlink" href="#save-an-spatialrdd-indexed" title="Permanent link">&para;</a></h3>
<p>Indexed typed SpatialRDD and generic SpatialRDD can be saved to permanent storage. However, the indexed SpatialRDD has to be stored as a distributed object file.</p>
<h4 id="save-to-distributed-object-file_1">Save to distributed object file<a class="headerlink" href="#save-to-distributed-object-file_1" title="Permanent link">&para;</a></h4>
<p>Use the following code to save an SpatialRDD as a distributed object file:</p>
<div class="codehilite"><pre><span></span>objectRDD.indexedRawRDD.saveAsObjectFile(&quot;hdfs://PATH&quot;)
</pre></div>

<h3 id="save-an-spatialrdd-spatialpartitioned-wo-indexed">Save an SpatialRDD (spatialPartitioned W/O indexed)<a class="headerlink" href="#save-an-spatialrdd-spatialpartitioned-wo-indexed" title="Permanent link">&para;</a></h3>
<p>A spatial partitioned RDD can be saved to permanent storage but Spark is not able to maintain the same RDD partition Id of the original RDD. This will lead to wrong join query results. We are working on some solutions. Stay tuned!</p>
<h3 id="reload-a-saved-spatialrdd">Reload a saved SpatialRDD<a class="headerlink" href="#reload-a-saved-spatialrdd" title="Permanent link">&para;</a></h3>
<p>You can easily reload an SpatialRDD that has been saved to <mark>a distributed object file</mark>.</p>
<h4 id="load-to-a-typed-spatialrdd">Load to a typed SpatialRDD<a class="headerlink" href="#load-to-a-typed-spatialrdd" title="Permanent link">&para;</a></h4>
<p>Use the following code to reload the PointRDD/PolygonRDD/LineStringRDD:</p>
<div class="codehilite"><pre><span></span><span class="k">var</span> <span class="n">savedRDD</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PointRDD</span><span class="o">(</span><span class="n">sc</span><span class="o">.</span><span class="n">objectFile</span><span class="o">[</span><span class="kt">Point</span><span class="o">](</span><span class="s">&quot;hdfs://PATH&quot;</span><span class="o">))</span>

<span class="k">var</span> <span class="n">savedRDD</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PointRDD</span><span class="o">(</span><span class="n">sc</span><span class="o">.</span><span class="n">objectFile</span><span class="o">[</span><span class="kt">Polygon</span><span class="o">](</span><span class="s">&quot;hdfs://PATH&quot;</span><span class="o">))</span>

<span class="k">var</span> <span class="n">savedRDD</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">PointRDD</span><span class="o">(</span><span class="n">sc</span><span class="o">.</span><span class="n">objectFile</span><span class="o">[</span><span class="kt">LineString</span><span class="o">](</span><span class="s">&quot;hdfs://PATH&quot;</span><span class="o">))</span>
</pre></div>

<h4 id="load-to-a-generic-spatialrdd">Load to a generic SpatialRDD<a class="headerlink" href="#load-to-a-generic-spatialrdd" title="Permanent link">&para;</a></h4>
<p>Use the following code to reload the SpatialRDD:</p>
<div class="codehilite"><pre><span></span><span class="k">var</span> <span class="n">savedRDD</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">SpatialRDD</span><span class="o">[</span><span class="kt">Geometry</span><span class="o">]</span>
<span class="n">savedRDD</span><span class="o">.</span><span class="n">rawSpatialRDD</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">objectFile</span><span class="o">[</span><span class="kt">Geometry</span><span class="o">](</span><span class="s">&quot;hdfs://PATH&quot;</span><span class="o">)</span>
</pre></div>

<p>Use the following code to reload the indexed SpatialRDD:
<div class="codehilite"><pre><span></span><span class="k">var</span> <span class="n">savedRDD</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">SpatialRDD</span><span class="o">[</span><span class="kt">Geometry</span><span class="o">]</span>
<span class="n">savedRDD</span><span class="o">.</span><span class="n">indexedRawRDD</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">objectFile</span><span class="o">[</span><span class="kt">SpatialIndex</span><span class="o">](</span><span class="s">&quot;hdfs://PATH&quot;</span><span class="o">)</span>
</pre></div></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../download/compile/" title="Compile the source code" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Compile the source code
              </span>
            </div>
          </a>
        
        
          <a href="../sql/" title="Spatial SQL application" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Spatial SQL application
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/DataSystemsLab/GeoSpark" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/GeoSpark_ASU" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.8eb9be28.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-64886725-1","www.public.asu.edu/~jiayu2/geospark/index.html"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>